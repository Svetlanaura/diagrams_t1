@startuml
|Клиент|
start
:Регистрация/авторизация;
|Система|
:Подтверждение учётных данных;
if (Данные верны?) then (да)
  |Клиент|
  :Выбор товаров;
  :Добавление в корзину;
  :Оформление заказа;
  :Выбор доставки и оплаты;
  |Система|
  :Проверка наличия товара;
  if (Все товары в наличии?) then (да)
    fork
      |Клиент|
      :Выбор способа оплаты;
      |Система|
      :Проверка платёжных данных;
      if (Оплата успешна?) then (да)
        :Транзакция проведена;
      else (нет)
        :Уведомление о проблеме с оплатой;
        |Клиент|
        :Выбор повторной оплаты или изменение способа;
        if (Клиент устраивает решение?) then (да)
          -> [возврат к выбору оплаты]
        else (нет)
          |Система|
          :Отмена заказа;
          :Возврат средств (если списаны);
          stop
        endif
      endif
      |Система|
      :Генерация счёта-фактуры;
      :Уведомление клиента о подтверждении заказа;
      :Обновление статуса заказа на "Отправлен";
      stop
    fork again
      |Система|
      :Уведомление склада о сборке заказа;
      |Склад|
      :Комплектация заказа;
      :Готовность к отправке;
    end fork

  else (нет)
    |Система|
    :Уведомление клиента о недоступности товара;
    |Клиент|
    :Выбор альтернативного товара или удаление из заказа;
    -> [возврат к оформлению заказа]
  endif

else (нет)
  |Система|
  :Уведомление о неверных данных;
  stop
endif

|Система|
:Обновление статуса заказа;
|Клиент|
:Получение уведомлений о статусах (подтверждение, отправка, доставка);
stop

@enduml
